
@{

    Layout = null;
}

<div id="loading" style="position: absolute; left: 50%; top: 50%; z-index: 50000; display: none">
    <b>cargando ...</b>
    <img src="../../../images/loading_page.gif" width="20" height="20" />
</div>

<br />

<div class="row">
    <label class="col-lg-12 control-label text-center">Fecha inicio</label>
    <div class="row">
        <div class="col-lg-5"></div>
        <div class="col-lg-2"><input type="date" id="idfechainicio" class="form-control fecha" /></div>
        <div class="col-lg-5"></div>
    </div>
    <label class="col-lg-12 control-label text-center">Fecha corte</label>
    <div class="row">
        <div class="col-lg-5"></div>
        <div class="col-lg-2"><input type="date" id="idfechacorte" class="form-control fecha" /></div>
        <div class="col-lg-5"></div>
    </div>
    <div class="row">
        <div class="col-lg-5"></div>
        <div class="col-lg-1"><button type="button" id="btn_generar_informe" class="btn btn-primary" style="width:100%">Excel detalle</button></div>
        <div class="col-lg-1"><button type="button" id="btn_generar_informe_resumen" class="btn btn-primary" style="width:100%">Excel resumen</button></div>
        <div class="col-lg-5"></div>
    </div>
</div>


<div class="row">
    <div class="col-lg-3 col-md-3 col-xs-0"></div>
    <div class="col-lg-6 col-md-6 col-xs-12" id="divpartialExportadorExcel"></div>
    <div class="col-lg-3 col-md-3 col-xs-0"></div>
</div>

<script>

    $(document).ready(function () {

        var d = new Date();
        var curDay = d.getDate();
        var curMonth = d.getMonth() + 1;
        var curYear = d.getFullYear();

        var fi = curYear + "-" + (curMonth < 10 ? "0" + curMonth : curMonth) + "-01";
        var ft = curYear + "-" + (curMonth < 10 ? "0" + curMonth : curMonth) + "-" + (curDay < 10 ? "0" + curDay : curDay);

        $('#idfechainicio').val(fi);
        $("#idfechacorte").val(ft);

        $("#btn_generar_informe").on('click', function (e) {
            e.preventDefault();


            cargar_informe();
        });

        $("#btn_generar_informe_resumen").on('click', function (e) {
            e.preventDefault();


            cargar_informe_resumen();
        });

    });


    function cargar_informe() {

        var fechai = $('#idfechainicio').val();
        var fechac = $('#idfechacorte').val();
        $("#loading").show();
        window.open("/Informes/Excel_Historico?fechai=" + fechai + "&fechac=" + fechac, '_blank');
        $("#loading").hide();
    }

    function cargar_informe_resumen() {

        var fechai = $('#idfechainicio').val();
        var fechac = $('#idfechacorte').val();
        $("#loading").show();
        window.open("/Informes/Excel_Historico_Resumen?fechai=" + fechai + "&fechac=" + fechac, '_blank');
        $("#loading").hide();
    }

</script>

